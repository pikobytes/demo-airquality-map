(this["webpackJsonpdemo-airquality-map"]=this["webpackJsonpdemo-airquality-map"]||[]).push([[0],{106:function(e,a,t){},107:function(e,a,t){},108:function(e,a,t){"use strict";t.r(a);var n=t(0),o=t.n(n),r=t(11),i=t.n(r),s=t(59),c=(t(81),t(146)),l=t(147),d=t(68),p=Object(d.a)({overrides:{},palette:{primary:{light:"#58a5f0",main:"#0277bd",dark:"#004c8c",contrastText:"#ffffff",text:"#ffffff"},secondary:{light:"#efdcd5",main:"#bcaaa4",dark:"#8c7b75",contrastText:"#000000",text:"#000000"}},typography:{fontSize:12,useNextVariants:!0}}),u=t(37),m=t.n(u),h=t(42),f=t(17),b=t(12),g=t(18),v=t(19),y=t(21),w=t(43),k=t.n(w),x=(t(99),t(3)),E=t(4),j=t(30),S=t.n(j),C=function(e){function a(e){var t;return Object(f.a)(this,a),(t=Object(g.a)(this,Object(v.a)(a).call(this,e))).handleMouseMove=function(e){t.props.map.getCanvas().style.cursor="pointer",e.features.length>0&&(t.setState({selected:e.features[0]},t.renderPopup),console.log(e.features.map((function(e){return e.properties.over50}))))},t.handleMouseLeave=function(){t.props.map.getCanvas().style.cursor="",t.setState({selected:void 0},t.renderPopup)},t.renderPopup=function(){var e=t.state,a=e.popup,n=e.selected,o=t.props.map;if(a&&a.remove(),void 0!==n){var r=n.geometry,i=n.properties,s=i.href.split("/devices/")[1];s=s.split("/sensors/");var c="".concat(s[0],"/").concat(s[1]),l=new S.a.Popup({className:"pb-map-popup",closeButton:!1}).setLngLat(r.coordinates).setHTML('<div class="popup-content">'+'<span class="title">'.concat(c,"</span>")+'<span class="value">Days over 50\xb5g/m\xb3: <span>'.concat(i.over50,"</span></span>")+"</div>").addTo(o);t.setState({popup:l})}else t.setState({popup:void 0})},t.state={popup:void 0,selected:void 0},t}return Object(y.a)(a,e),Object(b.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,a=e.data,t=e.map;t.addSource("data-source-1",{type:"geojson",data:a}),t.addLayer({id:"data-layer-points-1",source:"data-source-1",type:"circle",paint:{"circle-radius":{base:1.75,stops:[[5,3],[8,5],[16,10],[22,180]]},"circle-color":["step",["get","over50"],"#2167fe",7,"#2d9dfe",14,"#66affe",21,"#99c6fc",28,"#b4e5fe",35,"#fdfdbe",42,"#fefe00",49,"#feaa00",56,"#fd0000",63,"#a80000",70,"#a900e6"]}}),t.on("mousemove","data-layer-points-1",this.handleMouseMove),t.on("mouseleave","data-layer-points-1",this.handleMouseLeave)}},{key:"componentWillUnmount",value:function(){var e=this.props.map;e.off("mousemove","data-layer-points-1",this.handleMouseMove),e.off("mouseleave","data-layer-points-1",this.handleMouseLeave)}},{key:"componentDidUpdate",value:function(){this.props.map.getSource("data-source-1").setData(this.props.data)}},{key:"render",value:function(){return o.a.createElement("div",{style:{display:"none"}})}}]),a}(n.Component);C.defaultProps={data:{type:"FeatureCollection",features:[]}};var O=C,z=(t(100),function(e){function a(e){var t;return Object(f.a)(this,a),(t=Object(g.a)(this,Object(v.a)(a).call(this,e))).state={map:void 0,refMap:o.a.createRef()},t}return Object(y.a)(a,e),Object(b.a)(a,[{key:"componentDidMount",value:function(){var e=this,a=this.state.refMap,t=this.props,n=t.mapboxStyle,o=t.mapboxToken,r=t.viewport;S.a.accessToken=o;var i=new S.a.Map({bearing:r.bearing,center:[r.longitude,r.latitude],container:a.current,pitch:r.pitch,style:n,zoom:r.zoom});i.dragRotate.disable(),i.touchZoomRotate.disableRotation(),i.addControl(new S.a.NavigationControl({showCompass:!1})),i.on("load",(function(){e.setState({map:i}),e.props.onLoad&&e.props.onLoad(i)}))}},{key:"componentDidUpdate",value:function(e,a,t){var n=this.state.map,o=this.props,r=o.width,i=o.height;void 0===n||r===e.width&&i===e.height||n.resize()}},{key:"componentWillUnmount",value:function(){var e=this.state.map;void 0!==e&&e.remove()}},{key:"render",value:function(){var e=this.state.refMap,a=this.props,t=a.children,n=a.height,r=a.width;return o.a.createElement("div",{ref:e,style:{width:"".concat(r,"px"),height:"".concat(n,"px")}},t)}}]),a}(n.Component));z.defaultProps={reducedStyle:!1,disableInteractions:!1};var M=t(29),N=t(138),L=t(139),T=t(140),D=t(141),F=t(142),I=t(150),R=t(152),U=t(149),B=t(41),H=Object(E.a)((function(e){return{root:{"label + &":{marginTop:e.spacing(3)}},input:{borderRadius:4,position:"relative",backgroundColor:e.palette.background.paper,border:"1px solid #ced4da",fontSize:16,padding:"10px 26px 10px 12px",transition:e.transitions.create(["border-color","box-shadow"]),fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:focus":{borderRadius:4,borderColor:"#80bdff",boxShadow:"0 0 0 0.2rem rgba(0,123,255,.25)"}}}}))(I.a),P=[{label:"0-7 Tage",color:"#2167fe"},{label:"> 14 Tage",color:"#66affe"},{label:"> 21 Tage",color:"#99c6fc"},{label:"> 28 Tage",color:"#b4e5fe"},{label:"> 35 Tage",color:"#fdfdbe"},{label:"> 42 Tage",color:"#fefe00"},{label:"> 49 Tage",color:"#feaa00"},{label:"> 56 Tage",color:"#fd0000"},{label:"> 63 Tage",color:"#a80000"},{label:"> 70 Tage",color:"#a900e6"}],W=function(e){function a(e){var t;return Object(f.a)(this,a),(t=Object(g.a)(this,Object(v.a)(a).call(this,e))).handleChange=function(e){t.props.onChange(e.target.value)},t}return Object(y.a)(a,e),Object(b.a)(a,[{key:"render",value:function(){var e=this.props,a=e.className,t=e.classes,n=e.currentYear,r=e.metadata;return o.a.createElement("div",{className:Object(x.a)(t.root,"pb-map-legend",a)},o.a.createElement(N.a,{className:t.formControl},o.a.createElement(R.a,{id:"customized-select"},"Evaluation year"),o.a.createElement(U.a,{id:"customized-select",value:n,onChange:this.handleChange,input:o.a.createElement(H,null)},[{year:"",path:void 0}].concat(Object(M.a)(r.slices)).map((function(e,a){return o.a.createElement("option",{key:a,value:e.year},e.year)})))),o.a.createElement(B.a,{component:"p",variant:"body1"},"Number of exceedances of the particulate matter PM10 daily mean value of 50 \xb5g/m3 in ",n,"."),o.a.createElement(L.a,{className:t.containerList},P.map((function(e,a){return o.a.createElement(T.a,{key:a},o.a.createElement(D.a,null,o.a.createElement("div",{className:t.icon,style:{backgroundColor:e.color}})),o.a.createElement(F.a,{primary:e.label}))}))),o.a.createElement(B.a,{component:"p",variant:"body1"},"Data is based on ",o.a.createElement("a",{href:"https://opensensorweb.de",target:"_blank",rel:"noopener noreferrer"},"OpenSensorWeb")," was lastly update on ",r.lastUpdate,"."))}}]),a}(n.Component);W.defaultProps={className:"",currentYear:"",metadata:{lastUpdate:"2020-03-01",slices:[]},onChange:function(){}};var A=Object(E.a)((function(e){return{root:{zIndex:1020,position:"absolute",right:10,bottom:67,width:300,backgroundColor:"#FFFFFF",boxShadow:"0 2px 2px 0 rgba(0,0,0,0.14), 0 3px 1px -2px rgba(0,0,0,0.12), 0 1px 5px 0 rgba(0,0,0,0.2)",padding:e.spacing(1),"& > p":{fontSize:12,color:"rgba(0,0,0,0.6)"}},containerList:{},icon:{width:16,height:16},formControl:{margin:e.spacing(0,0,2,0),width:300-e.spacing(2),cursor:"pointer"}}}))(W),Y=t(2),G=t(62),q=t.n(G),V=t(64),Z=t.n(V),J=t(65),_=t.n(J),Q=t(66),K=t.n(Q),X=t(40),$=t(144),ee=t(145),ae=t(148),te=t(151),ne=t(63),oe=t.n(ne),re=t(143),ie={success:q.a,warning:oe.a,error:Z.a,info:_.a},se=Object(re.a)((function(e){return{success:{backgroundColor:X.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.main},warning:{backgroundColor:$.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"},margin:{margin:e.spacing(1)}}}));function ce(e){var a=se(),t=e.className,n=e.message,r=e.onClose,i=e.variant,s=Object(Y.a)(e,["className","message","onClose","variant"]),c=ie[i];return o.a.createElement(ae.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!0,autoHideDuration:6e3,onClose:r},o.a.createElement(te.a,Object.assign({className:Object(x.a)(a[i],t),"aria-describedby":"client-snackbar",message:o.a.createElement("span",{id:"client-snackbar",className:a.message},o.a.createElement(c,{className:Object(x.a)(a.icon,a.iconVariant)}),n),action:[o.a.createElement(ee.a,{key:"close","aria-label":"close",color:"inherit",onClick:r},o.a.createElement(K.a,{className:a.icon}))]},s)))}var le=t(67),de=t.n(le),pe=(t(106),function(e){function a(){var e,t;Object(f.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=Object(g.a)(this,(e=Object(v.a)(a)).call.apply(e,[this].concat(o)))).state={width:0,height:0,currentYear:"",metadata:void 0,data:void 0,map:void 0,feedback:void 0},t.fetchInitialData=Object(h.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.get("data/metadata.json");case 3:200===(a=e.sent).status&&t.setState({metadata:a.data},(function(){var e=t.state.metadata;if(e.slices.length>0){var a=e.slices[e.slices.length-1];t.setState({currentYear:a.year}),t.fetchSelectData(a.path)}})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.setState({feedback:{message:e.t0.message,variant:"error"}});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),t.fetchSelectData=function(){var e=Object(h.a)(m.a.mark((function e(a){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.get(a);case 3:200===(n=e.sent).status&&t.setState({data:n.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.setState({feedback:{message:e.t0.message,variant:"error"}});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(a){return e.apply(this,arguments)}}(),t.handleChangeData=function(e){var a=t.state.metadata;t.setState({currentYear:e},(function(){if(void 0!==a){var n=a.slices.find((function(a){return a.year===e}));void 0===n?t.setState({data:void 0}):t.fetchSelectData(n.path)}}))},t.handleCloseFeedback=function(){t.setState({feedback:void 0})},t.handleMapLoad=function(e){void 0===t.state.map&&(e.on("moveend",(function(e){console.log(e.target.getZoom())})),t.setState({map:e}))},t.handleResize=function(){t.setState({width:window.innerWidth,height:window.innerHeight-40})},t}return Object(y.a)(a,e),Object(b.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize),this.handleResize(),this.fetchInitialData()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=this.state,a=e.currentYear,t=e.height,n=e.width,r=e.map,i=e.metadata,s=e.data,c=e.feedback,l=this.props.classes;return o.a.createElement("div",{className:Object(x.a)(l.root,"pb-airquality-map")},o.a.createElement("main",{className:Object(x.a)(l.content)},o.a.createElement("div",{className:l.containerLogo},o.a.createElement("img",{src:de.a,alt:""})),o.a.createElement("div",{className:l.containerMap},n>0&&t>0&&o.a.createElement(z,{height:t,mapboxStyle:"mapbox://styles/pikobytes/cjhkafemq0e6j2rr3jq4gg1by",mapboxToken:"pk.eyJ1IjoicGlrb2J5dGVzIiwiYSI6ImNrN2Fmam9razB6dGUzZ3M0ZWs4M2dxNnAifQ.euPoZAHChTNu2WpMyWcOpg",onLoad:this.handleMapLoad,viewport:{bearing:0,latitude:51.415,longitude:8.846,zoom:4,pitch:0},width:n},void 0!==r&&o.a.createElement(O,{data:s,map:r}))),void 0!==c&&o.a.createElement(ce,{className:"pb-snackbar-feedback",message:c.message,onClose:this.handleCloseFeedback,variant:c.variant}),o.a.createElement(A,{currentYear:a,metadata:i,onChange:this.handleChangeData})),o.a.createElement("div",{className:l.footer},o.a.createElement("div",null,o.a.createElement("a",{href:"https://www.opensensorweb.de/#/impressum",target:"_blank",rel:"noopener noreferrer"},"Impressum"),o.a.createElement("a",{href:"https://www.opensensorweb.de/#/privacy",target:"_blank",rel:"noopener noreferrer"},"Datenschutz"))))}}]),a}(n.Component)),ue=Object(E.a)((function(e){return{containerMap:{width:"100%",height:"100%",display:"block"},containerLogo:{position:"absolute",top:10,left:10,zIndex:1020,"& img":{width:250}},content:{flexGrow:1,marginBottom:40},root:{height:"100%",width:"100%",display:"flex"},footer:{position:"absolute",left:0,right:0,bottom:0,height:40,background:"#F5F5F5","& div":{marginTop:e.spacing(1.5),textAlign:"center"},"& a":{height:16,width:64,color:"rgba(0,0,0,0.6)",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontSize:14,letterSpacing:.4,lineHeight:"18px",textAlign:"center",textDecoration:"none"},"& a:hover":{color:"rgba(0,0,0,0.6)",textDecoration:"none"},"& a:first-child":{paddingRight:e.spacing(3)}}}}))(pe),me=(t(107),"ie"===Object(s.detect)().name);if(me){var he=document.getElementById("root"),fe=me?"<h2>Fehlende Browser Unterst\xfczung</h2><div>Die Anwendung unterst\xfctzt keinen Internet Explorer. Bitte wechseln Sie zu einem neueren Browser wie Chrome, Firefox, Edge, Opera oder Safari. ":"<h2>Fehlende WebGL Unterst\xfczung</h2><div>Ihr Browser unterst\xfctzt kein WebGL. Bitte wechseln Sie zu einer neueren Browser-Version von Chrome, Firefox, Edge, Opera oder Safari. ",be=document.createElement("h1");be.innerHTML='<div class="missing-browser-support">'.concat(fe).concat('Haben Sie anschlie\xdfend immer noch Probleme wenden Sie sich bitte an <a href="mailto:info@pikobytes.de" title="Contact Email">info@pikobytes.de</a>.',"</div></div>"),he.innerHTML="",he.appendChild(be)}else i.a.render(o.a.createElement(c.a,{theme:p},o.a.createElement(l.a,null),o.a.createElement(ue,null)),document.getElementById("root"))},67:function(e,a,t){e.exports=t.p+"static/media/pikobytes-logo-white.ffde0018.png"},76:function(e,a,t){e.exports=t(108)}},[[76,1,2]]]);
//# sourceMappingURL=main.737c1309.chunk.js.map